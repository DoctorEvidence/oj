<!DOCTYPE html>

<html>
<head>
  <title>qbSqlWindowTable.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="sqlBuilderInit.html">
                sqlBuilderInit.js
              </a>
            
              
              <a class="source" href="SqlDragDropTableJoinStore.html">
                SqlDragDropTableJoinStore.js
              </a>
            
              
              <a class="source" href="SqlTableJoinSprite.html">
                SqlTableJoinSprite.js
              </a>
            
              
              <a class="source" href="SqlTableNameStore.html">
                SqlTableNameStore.js
              </a>
            
              
              <a class="source" href="_initQbUI.html">
                _initQbUI.js
              </a>
            
              
              <a class="source" href="qbFineTuningGrid.html">
                qbFineTuningGrid.js
              </a>
            
              
              <a class="source" href="qbOutputPanel.html">
                qbOutputPanel.js
              </a>
            
              
              <a class="source" href="qbSqlWindowTable.html">
                qbSqlWindowTable.js
              </a>
            
              
              <a class="source" href="qbTableGrid.html">
                qbTableGrid.js
              </a>
            
              
              <a class="source" href="qbTablePanel.html">
                qbTablePanel.js
              </a>
            
              
              <a class="source" href="qbTablesTree.html">
                qbTablesTree.js
              </a>
            
              
              <a class="source" href="fields.html">
                fields.js
              </a>
            
              
              <a class="source" href="joins.html">
                joins.js
              </a>
            
              
              <a class="source" href="manager.html">
                manager.js
              </a>
            
              
              <a class="source" href="select.html">
                select.js
              </a>
            
              
              <a class="source" href="tables.html">
                tables.js
              </a>
            
              
              <a class="source" href="function.html">
                function.js
              </a>
            
              
              <a class="source" href="is.html">
                is.js
              </a>
            
              
              <a class="source" href="methods.html">
                methods.js
              </a>
            
              
              <a class="source" href="number.html">
                number.js
              </a>
            
              
              <a class="source" href="string.html">
                string.js
              </a>
            
              
              <a class="source" href="to.html">
                to.js
              </a>
            
              
              <a class="source" href="indexedDb.html">
                indexedDb.js
              </a>
            
              
              <a class="source" href="class.html">
                class.js
              </a>
            
              
              <a class="source" href="classDefinition.html">
                classDefinition.js
              </a>
            
              
              <a class="source" href="errors.html">
                errors.js
              </a>
            
              
              <a class="source" href="subscribers.html">
                subscribers.js
              </a>
            
              
              <a class="source" href="console.html">
                console.js
              </a>
            
              
              <a class="source" href="constant.html">
                constant.js
              </a>
            
              
              <a class="source" href="each.html">
                each.js
              </a>
            
              
              <a class="source" href="object.html">
                object.js
              </a>
            
              
              <a class="source" href="objectSql.html">
                objectSql.js
              </a>
            
              
              <a class="source" href="property.html">
                property.js
              </a>
            
              
              <a class="source" href="shims.html">
                shims.js
              </a>
            
              
              <a class="source" href="uuid.html">
                uuid.js
              </a>
            
              
              <a class="source" href="metaNode.html">
                metaNode.js
              </a>
            
              
              <a class="source" href="_nodeFactory.html">
                _nodeFactory.js
              </a>
            
              
              <a class="source" href="domNode.html">
                domNode.js
              </a>
            
              
              <a class="source" href="domNodeAttributes.html">
                domNodeAttributes.js
              </a>
            
              
              <a class="source" href="_element.html">
                _element.js
              </a>
            
              
              <a class="source" href="div.html">
                div.js
              </a>
            
              
              <a class="source" href="span.html">
                span.js
              </a>
            
              
              <a class="source" href="initChildNameSpaces.html">
                initChildNameSpaces.js
              </a>
            
              
              <a class="source" href="dataModel.html">
                dataModel.js
              </a>
            
              
              <a class="source" href="dataType.html">
                dataType.js
              </a>
            
              
              <a class="source" href="dataTypeCollection.html">
                dataTypeCollection.js
              </a>
            
              
              <a class="source" href="_selectionModel.html">
                _selectionModel.js
              </a>
            
              
              <a class="source" href="selectionModelCheckBox.html">
                selectionModelCheckBox.js
              </a>
            
              
              <a class="source" href="_selectionSubscribers.html">
                _selectionSubscribers.js
              </a>
            
              
              <a class="source" href="onDeselect.html">
                onDeselect.js
              </a>
            
              
              <a class="source" href="onSelect.html">
                onSelect.js
              </a>
            
              
              <a class="source" href="proxy.html">
                proxy.js
              </a>
            
              
              <a class="source" href="store.html">
                store.js
              </a>
            
              
              <a class="source" href="actionColumn.html">
                actionColumn.js
              </a>
            
              
              <a class="source" href="checkColumn.html">
                checkColumn.js
              </a>
            
              
              <a class="source" href="column.html">
                column.js
              </a>
            
              
              <a class="source" href="columnItem.html">
                columnItem.js
              </a>
            
              
              <a class="source" href="columns.html">
                columns.js
              </a>
            
              
              <a class="source" href="gridColumn.html">
                gridColumn.js
              </a>
            
              
              <a class="source" href="rendererColumn.html">
                rendererColumn.js
              </a>
            
              
              <a class="source" href="grid.html">
                grid.js
              </a>
            
              
              <a class="source" href="_gridSubscribers.html">
                _gridSubscribers.js
              </a>
            
              
              <a class="source" href="bodyscroll.html">
                bodyscroll.js
              </a>
            
              
              <a class="source" href="drop.html">
                drop.js
              </a>
            
              
              <a class="source" href="render.html">
                render.js
              </a>
            
              
              <a class="source" href="panel.html">
                panel.js
              </a>
            
              
              <a class="source" href="_panelSubscribers.html">
                _panelSubscribers.js
              </a>
            
              
              <a class="source" href="afterLayout.html">
                afterLayout.js
              </a>
            
              
              <a class="source" href="sheet.html">
                sheet.js
              </a>
            
              
              <a class="source" href="_sheetSubscribers.html">
                _sheetSubscribers.js
              </a>
            
              
              <a class="source" href="beforeclose.html">
                beforeclose.js
              </a>
            
              
              <a class="source" href="beforeshow.html">
                beforeshow.js
              </a>
            
              
              <a class="source" href="show.html">
                show.js
              </a>
            
              
              <a class="source" href="_structureSet.html">
                _structureSet.js
              </a>
            
              
              <a class="source" href="structureSet.html">
                structureSet.js
              </a>
            
              
              <a class="source" href="_treeSubscribers.html">
                _treeSubscribers.js
              </a>
            
              
              <a class="source" href="afterrender.html">
                afterrender.js
              </a>
            
              
              <a class="source" href="itemdbclick.html">
                itemdbclick.js
              </a>
            
              
              <a class="source" href="tree.html">
                tree.js
              </a>
            
              
              <a class="source" href="treeNode.html">
                treeNode.js
              </a>
            
              
              <a class="source" href="treeStore.html">
                treeStore.js
              </a>
            
              
              <a class="source" href="nameSpace.html">
                nameSpace.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>qbSqlWindowTable.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/* global window:true, Ext:true */</span>

(<span class="function"><span class="keyword">function</span> <span class="params">(n$)</span> {</span>

    <span class="keyword">var</span> getOffset = <span class="function"><span class="keyword">function</span> <span class="params">(thisView, constrain)</span> {</span>
        <span class="keyword">var</span> xy = thisView.dd.getXY(constrain), s = thisView.dd.startXY;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>return the the difference between the current and the drag&amp;drop start position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">return</span> [xy[<span class="number">0</span>] - s[<span class="number">0</span>], xy[<span class="number">1</span>] - s[<span class="number">1</span>]];
    };

    <span class="keyword">var</span> closeSQLTable = <span class="function"><span class="keyword">function</span> <span class="params">(thisView)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>remove fields / columns from SqlFineTuningStore</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        n$.actions.sql.manager.select.fields.removeFieldsByTableId(thisView.tableId);</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>remove table from sqlTables store inside n$.actions.sql.manager.sqlSelect</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        n$.actions.sql.manager.select.tables.removeTableById(thisView.tableId);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>unregister mousedown event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        thisView.getHeader().el.un(<span class="string">'mousedown'</span>, <span class="function"><span class="keyword">function</span> <span class="title">_doRegStartDrag</span><span class="params">()</span> {</span> regStartDrag(thisView); }, thisView);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>unregister mousemove event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Ext.EventManager.un(document, <span class="string">'mousemove'</span>, <span class="function"><span class="keyword">function</span> <span class="title">_doMoveWindow</span><span class="params">()</span> {</span> moveWindow(thisView); }, thisView);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>remove sprite from surface</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Ext.getCmp(<span class="string">'qbTablePanel'</span>).down(<span class="string">'draw'</span>).surface.remove(thisView.shadowSprite, <span class="literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>remove any connection lines from surface and from array n$.actions.sql.manager.connections</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        n$.actions.sql.manager.connections = Ext.Array.filter(n$.actions.sql.manager.connections, <span class="function"><span class="keyword">function</span> <span class="params">(connection)</span> {</span>
            <span class="keyword">var</span> bRemove = <span class="literal">true</span>;
            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, l = <span class="keyword">this</span>.connectionUUIDs.length; j &lt; l; j++) {
                <span class="keyword">if</span> (connection.uuid == <span class="keyword">this</span>.connectionUUIDs[j]) {
                    connection.line.remove();
                    connection.bgLine.remove();
                    connection.miniLine1.remove();
                    connection.miniLine2.remove();
                    bRemove = <span class="literal">false</span>;
                }
            }
            <span class="keyword">return</span> bRemove;
        }, thisView);

    };

    <span class="keyword">var</span> initSQLTable = <span class="function"><span class="keyword">function</span> <span class="params">(thisView)</span> {</span>
        <span class="keyword">var</span> qbTablePanel, xyParentPos, xyChildPos, childSize, sprite;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>get the main qbTablePanel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        qbTablePanel = Ext.getCmp(<span class="string">'qbTablePanel'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>get the main qbTablePanel position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        xyParentPos = qbTablePanel.el.getXY();</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>get position of the previously added qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        xyChildPos = thisView.el.getXY();</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>get the size of the previously added qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        childSize = thisView.el.getSize();</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>create a sprite of type rectangle and set its position and size
to position and size of the the qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        sprite = <span class="keyword">new</span> n$.actions.querybuilder.SqlTableJoinSprite({
            type: <span class="string">'rect'</span>,
            stroke: <span class="string">'#fff'</span>,
            height: childSize.height - <span class="number">4</span>,
            width: childSize.width - <span class="number">4</span>,
            x: xyChildPos[<span class="number">0</span>] - xyParentPos[<span class="number">0</span>] + <span class="number">2</span>,
            y: xyChildPos[<span class="number">1</span>] - xyParentPos[<span class="number">1</span>] + <span class="number">2</span>,
            scrollTop: <span class="number">0</span>
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>add the sprite to the surface of the qbTablePanel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        thisView.shadowSprite = qbTablePanel.down(<span class="string">'draw'</span>).surface.add(sprite).show(<span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>handle resizeing of sqltabel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        thisView.resizer.on(<span class="string">'resize'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(resizer, width, height, event)</span> {</span>
            <span class="keyword">var</span> thisViewEl = <span class="keyword">this</span>;
            thisViewEl.shadowSprite.setAttributes({
                width: width - <span class="number">6</span>,
                height: height - <span class="number">6</span>
            }, <span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>also move the associated connections</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">for</span> (<span class="keyword">var</span> i = n$.actions.sql.manager.connections.length; i--;) {
                connection(thisViewEl, n$.actions.sql.manager.connections[i]);
            }
        }, thisView);</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>register a function for the mousedown event on the previously added qbSqlWindowTable and bind to thisView scope</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        thisView.getHeader().el.on(<span class="string">'mousedown'</span>, <span class="function"><span class="keyword">function</span> <span class="title">_doRegStartDrag</span><span class="params">()</span> {</span> regStartDrag(thisView); }, thisView);

        thisView.getHeader().el.on(<span class="string">'contextmenu'</span>, <span class="function"><span class="keyword">function</span> <span class="title">_doShowSqlTable</span><span class="params">()</span> {</span> showSQLTableCM(thisView); }, thisView);

        thisView.getHeader().el.on(<span class="string">'dblclick'</span>, <span class="function"><span class="keyword">function</span> <span class="title">_doShowTableAliasEdit</span><span class="params">()</span> {</span> showTableAliasEditForm(thisView); }, thisView);

        thisView.getHeader().origValue = <span class="string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>register method thisView.moveWindow for the mousemove event on the document and bind to thisView scope</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Ext.EventManager.on(document, <span class="string">'mousemove'</span>, <span class="function"><span class="keyword">function</span> <span class="title">_doMoveWindow</span><span class="params">()</span> {</span> moveWindow(thisView); }, thisView);</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>register a function for the mouseup event on the document and add the thisView scope</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Ext.EventManager.on(document, <span class="string">'mouseup'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>save the mousedown state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            thisView.bMouseDown = <span class="literal">false</span>;
        }, thisView);


    };

    <span class="keyword">var</span> showSQLTableCM = <span class="function"><span class="keyword">function</span> <span class="params">(thisView, event, el)</span> {</span>
        <span class="keyword">var</span> cm;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>stop the browsers event bubbling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        event.stopEvent();</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>create context menu</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        cm = Ext.create(<span class="string">'Ext.menu.Menu'</span>, {
            items: [{
                text: <span class="string">'Add/Edit Alias'</span>,
                icon: <span class="string">'resources/images/document_edit16x16.gif'</span>,
                handler: Ext.Function.bind(<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                    showTableAliasEditForm(<span class="keyword">this</span>);
                }, <span class="keyword">this</span>)
            }, {
                text: <span class="string">'Remove Table'</span>,
                icon: <span class="string">'resources/images/delete.gif'</span>,
                handler: Ext.Function.bind(<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>remove the qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="keyword">this</span>.close();
                }, <span class="keyword">this</span>)
            }, {
                text: <span class="string">'Close Menu'</span>,
                icon: <span class="string">'resources/images/cross.gif'</span>,
                handler: Ext.emptyFn
            }]
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>show the contextmenu next to current mouse position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        cm.showAt(event.getXY());
    };

    <span class="keyword">var</span> showTableAliasEditForm = <span class="function"><span class="keyword">function</span> <span class="params">(thisView, event, el)</span> {</span>
        <span class="keyword">var</span> table, header, title, titleId;
        table = n$.actions.sql.manager.select.tables.getTableById(<span class="keyword">this</span>.tableId);
        header = thisView.getHeader();
        titleId = <span class="string">'#'</span> + header.getId() + <span class="string">'_hd'</span>;
        title = thisView.down(titleId);
        header.remove(title);
        header.insert(<span class="number">0</span>, [{
            xtype: <span class="string">'textfield'</span>,
            flex: <span class="number">0.95</span>,
            parentCmp: header,
            parentTableModel: table,
            initComponent: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

                <span class="keyword">this</span>.setValue(<span class="keyword">this</span>.parentTableModel.get(<span class="string">'tableAlias'</span>));

                <span class="keyword">this</span>.on(<span class="string">'render'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(field, event)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>set focus to the textfield Benutzerkennung</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    field.focus(<span class="literal">true</span>, <span class="number">200</span>);
                }, <span class="keyword">this</span>);

                <span class="keyword">this</span>.on(<span class="string">'specialkey'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(field, event)</span> {</span>
                    <span class="keyword">if</span> (event.getKey() == event.ENTER) {
                        <span class="keyword">if</span> (field.getValue() != <span class="keyword">this</span>.parentCmp.origValue) {
                            <span class="keyword">this</span>.parentTableModel.set(<span class="string">'tableAlias'</span>, field.getValue());
                            <span class="keyword">this</span>.parentCmp.origValue = field.getValue();
                        }
                        <span class="keyword">this</span>.removeTextField();
                        <span class="keyword">this</span>.addTitle();
                    }
                }, <span class="keyword">this</span>);

                <span class="keyword">this</span>.on(<span class="string">'blur'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(field, event)</span> {</span>
                    <span class="keyword">if</span> (field.getValue() != <span class="keyword">this</span>.parentCmp.origValue) {
                        <span class="keyword">this</span>.parentTableModel.set(<span class="string">'tableAlias'</span>, field.getValue());
                        <span class="keyword">this</span>.parentCmp.origValue = field.getValue();
                    }
                    <span class="keyword">this</span>.removeTextField();
                    <span class="keyword">this</span>.addTitle();
                }, <span class="keyword">this</span>);

                <span class="keyword">this</span>.callParent(arguments);
            },
            removeTextField: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                <span class="keyword">var</span> next;
                next = <span class="keyword">this</span>.next();
                <span class="keyword">this</span>.parentCmp.remove(next);
                <span class="keyword">this</span>.parentCmp.remove(<span class="keyword">this</span>);
            },
            addTitle: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                <span class="keyword">var</span> titleText;
                <span class="keyword">if</span> (<span class="keyword">this</span>.parentTableModel.get(<span class="string">'tableAlias'</span>) != <span class="string">''</span>) {
                    titleText = <span class="keyword">this</span>.parentTableModel.get(<span class="string">'tableAlias'</span>) + <span class="string">' ( '</span> + <span class="keyword">this</span>.parentTableModel.get(<span class="string">'tableName'</span>) + <span class="string">' )'</span>;
                } <span class="keyword">else</span> {
                    titleText = <span class="keyword">this</span>.parentTableModel.get(<span class="string">'tableName'</span>);
                }
                <span class="keyword">this</span>.parentCmp.insert(<span class="number">0</span>, {
                    xtype: <span class="string">'component'</span>,
                    ariaRole: <span class="string">'heading'</span>,
                    focusable: <span class="literal">false</span>,
                    noWrap: <span class="literal">true</span>,
                    flex: <span class="number">1</span>,
                    id: <span class="keyword">this</span>.parentCmp.id + <span class="string">'_hd'</span>,
                    style: <span class="string">'text-align:'</span> + <span class="keyword">this</span>.parentCmp.titleAlign,
                    cls: <span class="keyword">this</span>.parentCmp.baseCls + <span class="string">'-text-container'</span>,
                    renderTpl: <span class="keyword">this</span>.parentCmp.getTpl(<span class="string">'headingTpl'</span>),
                    renderData: {
                        title: titleText,
                        cls: <span class="keyword">this</span>.parentCmp.baseCls,
                        ui: <span class="keyword">this</span>.parentCmp.ui
                    },
                    childEls: [<span class="string">'textEl'</span>]
                });
            }
        }, {
            xtype: <span class="string">'component'</span>,
            flex: <span class="number">0.05</span>
        }]);
    };


    <span class="keyword">var</span> regStartDrag = <span class="function"><span class="keyword">function</span> <span class="params">(thisView)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>save the mousedown state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        thisView.bMouseDown = <span class="literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>start the drag of the sprite</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        thisView.shadowSprite.startDrag(thisView.getId());
    };

    <span class="keyword">var</span> moveWindow = <span class="function"><span class="keyword">function</span> <span class="params">(thisView, event, domEl, opt)</span> {</span>
        <span class="keyword">var</span> relPosMovement;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>check mousedown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (thisView.bMouseDown) {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>get relative x and y values (offset)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            relPosMovement = getOffset(thisView, <span class="string">'point'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>move the sprite to the position of the window</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            thisView.shadowSprite.onDrag(relPosMovement);</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>check if the sprite has any connections</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">if</span> (thisView.shadowSprite.bConnections) {</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>also move the associated connections</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="keyword">for</span> (<span class="keyword">var</span> i = n$.actions.sql.manager.connections.length; i--;) {
                    connection(thisView, n$.actions.sql.manager.connections[i]);
                }
            }
        }
    };

    <span class="keyword">var</span> getLeftRightCoordinates = <span class="function"><span class="keyword">function</span> <span class="params">(thisView, obj1, obj2, aBBPos)</span> {</span>
        <span class="keyword">var</span> bb1, bb2, p = [], dx, leftBoxConnectionPoint, rightBoxConnectionPoint, dis, columHeight = <span class="number">21</span>, headerHeight = <span class="number">46</span>, LeftRightCoordinates = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Get bounding coordinates for both sprites</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        bb1 = obj1.getBBox();</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Y value for the connection points on the left and right side of bb1</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        bb1.pY = bb1.y + headerHeight + ((aBBPos[<span class="number">0</span>] - <span class="number">1</span>) * columHeight) + (columHeight / <span class="number">2</span>) - obj1.scrollTop;

        bb2 = obj2.getBBox();</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Y value for the connection points on the left and right side of bb2</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        bb2.pY = bb2.y + headerHeight + ((aBBPos[<span class="number">1</span>] - <span class="number">1</span>) * columHeight) + (columHeight / <span class="number">2</span>) - obj2.scrollTop;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Left bounding box</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (bb1.pY &gt; (bb1.y + <span class="number">4</span>) &amp;&amp; bb1.pY &lt; (bb1.y + bb1.height - <span class="number">4</span>)) {
            p.push({
                x: bb1.x - <span class="number">1</span>, <span class="comment">// Point on the left side of the preview column</span>
                y: bb1.pY
            });
            p.push({
                x: bb1.x + bb1.width + <span class="number">1</span>, <span class="comment">// Point on the right side of the preview column</span>
                y: bb1.pY
            });
        } <span class="keyword">else</span> {
            <span class="keyword">if</span> (bb1.pY &lt; (bb1.y + <span class="number">4</span>)) {
                p.push({
                    x: bb1.x - <span class="number">1</span>, <span class="comment">// Highest point on the left side</span>
                    y: bb1.y + <span class="number">4</span>
                });
                p.push({
                    x: bb1.x + bb1.width + <span class="number">1</span>, <span class="comment">// Highest point on the right side</span>
                    y: bb1.y + <span class="number">4</span>
                });
            } <span class="keyword">else</span> {
                p.push({
                    x: bb1.x - <span class="number">1</span>, <span class="comment">// Lowest point on the left side</span>
                    y: bb1.y + bb1.height - <span class="number">4</span>
                });
                p.push({
                    x: bb1.x + bb1.width + <span class="number">1</span>, <span class="comment">// Lowest point on the right side</span>
                    y: bb1.y + bb1.height - <span class="number">4</span>
                });
            }

        }</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>The right bounding box</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (bb2.pY &gt; (bb2.y + <span class="number">4</span>) &amp;&amp; bb2.pY &lt; (bb2.y + bb2.height - <span class="number">4</span>)) {
            p.push({
                x: bb2.x - <span class="number">1</span>, <span class="comment">// Point on the left side of the preview column</span>
                y: bb2.pY
            });
            p.push({
                x: bb2.x + bb2.width + <span class="number">1</span>, <span class="comment">// Point on the right side of the preview column</span>
                y: bb2.pY
            });
        } <span class="keyword">else</span> {
            <span class="keyword">if</span> (bb2.pY &lt; (bb2.y + <span class="number">4</span>)) {
                p.push({
                    x: bb2.x - <span class="number">1</span>, <span class="comment">// Highest point on the left side.</span>
                    y: bb2.y + <span class="number">4</span>
                });
                p.push({
                    x: bb2.x + bb2.width + <span class="number">1</span>, <span class="comment">// Highest point on the right side.</span>
                    y: bb2.y + <span class="number">4</span>
                });
            } <span class="keyword">else</span> {
                p.push({
                    x: bb2.x - <span class="number">1</span>, <span class="comment">// Lowest point on the the left side.</span>
                    y: bb2.y + bb2.height - <span class="number">4</span>
                });

                p.push({
                    x: bb2.x + bb2.width + <span class="number">1</span>, <span class="comment">// Lowest point on the right side.</span>
                    y: bb2.y + bb2.height - <span class="number">4</span>
                });
            }
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>A loop over the points of the first BoundingBox</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) {</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>A loop over the points of the second BoundingBox</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">2</span>; j &lt; <span class="number">4</span>; j++) {</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Calculation of the offsets between the four points of both BoundingBoxes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                dx = Math.abs(p[i].x - p[j].x), dy = Math.abs(p[i].y - p[j].y);</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>bb1 left with bb2 right</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="keyword">if</span> (((i == <span class="number">0</span> &amp;&amp; j == <span class="number">3</span>) &amp;&amp; dx &lt; Math.abs(p[<span class="number">1</span>].x - p[<span class="number">2</span>].x)) || ((i == <span class="number">1</span> &amp;&amp; j == <span class="number">2</span>) &amp;&amp; dx &lt; Math.abs(p[<span class="number">0</span>].x - p[<span class="number">3</span>].x))) {
                    leftBoxConnectionPoint = p[i];
                    rightBoxConnectionPoint = p[j];
                }
            }
        }


        <span class="keyword">return</span> {
            leftBoxConnectionPoint: leftBoxConnectionPoint,
            rightBoxConnectionPoint: rightBoxConnectionPoint
        };

    };

    <span class="keyword">var</span> connection = <span class="function"><span class="keyword">function</span> <span class="params">(thisView, obj1, obj2, line, aBBPos)</span> {</span>
        <span class="keyword">var</span> LeftRightCoordinates, line1, line2, miniLine1, miniLine2, path, surface, color = <span class="keyword">typeof</span> line == <span class="string">"string"</span> ? line : <span class="string">"#000"</span>;
        <span class="keyword">var</span> ret = n$.object();
        
        <span class="keyword">if</span> (obj1.line &amp;&amp; obj1.from &amp;&amp; obj1.to &amp;&amp; obj1.aBBPos) {
            line = obj1;
            obj1 = line.from;
            obj2 = line.to;
            aBBPos = line.aBBPos;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>set reference to the wright surface</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        surface = obj1.surface;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>get coordinates for the left and right box</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        LeftRightCoordinates = getLeftRightCoordinates(thisView, obj1, obj2, aBBPos);</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>check if the LeftBox is still on the left side or not</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (LeftRightCoordinates.leftBoxConnectionPoint.x - LeftRightCoordinates.rightBoxConnectionPoint.x &lt; <span class="number">0</span>) {
            line1 = <span class="number">12</span>;
            line2 = <span class="number">12</span>;
        } <span class="keyword">else</span> {
            line1 = -<span class="number">12</span>;
            line2 = -<span class="number">12</span>;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>define the path between the left and the right box</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        path = [<span class="string">"M"</span>, LeftRightCoordinates.leftBoxConnectionPoint.x, LeftRightCoordinates.leftBoxConnectionPoint.y, <span class="string">"H"</span>, LeftRightCoordinates.leftBoxConnectionPoint.x + line1, <span class="string">"L"</span>, LeftRightCoordinates.rightBoxConnectionPoint.x - line2, LeftRightCoordinates.rightBoxConnectionPoint.y, <span class="string">"H"</span>, LeftRightCoordinates.rightBoxConnectionPoint.x].join(<span class="string">","</span>);

        miniLine1 = [<span class="string">"M"</span>, LeftRightCoordinates.leftBoxConnectionPoint.x, LeftRightCoordinates.leftBoxConnectionPoint.y, <span class="string">"H"</span>, LeftRightCoordinates.leftBoxConnectionPoint.x + line1].join(<span class="string">","</span>);

        miniLine2 = [<span class="string">"M"</span>, LeftRightCoordinates.rightBoxConnectionPoint.x - line2, LeftRightCoordinates.rightBoxConnectionPoint.y, <span class="string">"H"</span>, LeftRightCoordinates.rightBoxConnectionPoint.x].join(<span class="string">","</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>check if it is a new connection or not</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (line &amp;&amp; line.line) {</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>old connection, only change path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            line.bgLine &amp;&amp;
                line.bgLine.setAttributes({
                    path: path
                }, <span class="literal">true</span>);
            line.line.setAttributes({
                path: path
            }, <span class="literal">true</span>);
            line.miniLine1.setAttributes({
                path: miniLine1
            }, <span class="literal">true</span>);
            line.miniLine2.setAttributes({
                path: miniLine2
            }, <span class="literal">true</span>);
        } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>new connction, return new connection object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            ret = {
                line: Ext.create(<span class="string">'Ext.draw.Sprite'</span>, {
                    type: <span class="string">'path'</span>,
                    path: path,
                    stroke: color,
                    fill: <span class="string">'none'</span>,
                    <span class="string">'stroke-width'</span>: <span class="number">1</span>,
                    surface: surface
                }).show(<span class="literal">true</span>),
                miniLine1: Ext.create(<span class="string">'Ext.draw.Sprite'</span>, {
                    type: <span class="string">'path'</span>,
                    path: miniLine1,
                    stroke: color,
                    fill: <span class="string">'none'</span>,
                    <span class="string">'stroke-width'</span>: <span class="number">2</span>,
                    surface: surface
                }).show(<span class="literal">true</span>),
                miniLine2: Ext.create(<span class="string">'Ext.draw.Sprite'</span>, {
                    type: <span class="string">'path'</span>,
                    path: miniLine2,
                    stroke: color,
                    fill: <span class="string">'none'</span>,
                    <span class="string">'stroke-width'</span>: <span class="number">2</span>,
                    surface: surface
                }).show(<span class="literal">true</span>),
                bgLine: Ext.create(<span class="string">'Ext.draw.Sprite'</span>, {
                    type: <span class="string">'path'</span>,
                    path: path,
                    opacity: <span class="number">0</span>,
                    stroke: <span class="string">'#fff'</span>,
                    fill: <span class="string">'none'</span>,
                    <span class="string">'stroke-width'</span>: <span class="number">10</span>,
                    surface: surface
                }).show(<span class="literal">true</span>),
                from: obj1,
                to: obj2,
                aBBPos: aBBPos,
                uuid: n$.createUUID()
            };
        }
        <span class="keyword">return</span> ret;
    };

    <span class="keyword">var</span> onInit = <span class="keyword">function</span>(that) {
        <span class="keyword">var</span> store, tableModel;

        that.connectionUUIDs = [];
        that.bMouseDown = <span class="literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>asign a uuid to the window, this builds relationship with qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        that.tableId = n$.createUUID();


        store = Ext.create(<span class="string">'Ext.data.Store'</span>, {
            autoLoad: <span class="literal">true</span>,
            fields: [{
                name: <span class="string">'id'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'tableName'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'tableId'</span>,
                type: <span class="string">'string'</span>,
                defaultValue: that.tableId
            }, {
                name: <span class="string">'field'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'extCmpId'</span>,
                type: <span class="string">'string'</span>,
                defaultValue: that.id
            }, {
                name: <span class="string">'type'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'null'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'key'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'default'</span>,
                type: <span class="string">'string'</span>
            }, {
                name: <span class="string">'extra'</span>,
                type: <span class="string">'string'</span>
            }],
            proxy: {
                type: <span class="string">'memory'</span>,
                reader: {
                    type: <span class="string">'json'</span>,
                    root: <span class="string">'items'</span>
                }
            },
            data: { items: [{ <span class="string">"field"</span>: <span class="string">"*"</span>, <span class="string">"extra"</span>: <span class="string">""</span>, <span class="string">"id"</span>: <span class="string">"D04A39CB-AF22-A5F3-0246BA11FD51BCD8"</span>, <span class="string">"key"</span>: <span class="string">""</span>, <span class="string">"tableName"</span>: <span class="string">"library"</span>, <span class="string">"null"</span>: <span class="string">""</span>, <span class="string">"default"</span>: <span class="string">""</span>, <span class="string">"type"</span>: <span class="string">""</span> }, { <span class="string">"field"</span>: <span class="string">"libraryid"</span>, <span class="string">"extra"</span>: <span class="string">"auto_increment"</span>, <span class="string">"id"</span>: <span class="string">"D04A39CC-E436-C0BE-1D51AEF07A7A5AAF"</span>, <span class="string">"key"</span>: <span class="string">"PRI"</span>, <span class="string">"tableName"</span>: <span class="string">"library"</span>, <span class="string">"null"</span>: <span class="literal">false</span>, <span class="string">"default"</span>: <span class="string">""</span>, <span class="string">"type"</span>: <span class="string">"int(11)"</span> }, { <span class="string">"field"</span>: <span class="string">"opened"</span>, <span class="string">"extra"</span>: <span class="string">""</span>, <span class="string">"id"</span>: <span class="string">"D04A39CD-E13A-7228-81930472A5FC49AE"</span>, <span class="string">"key"</span>: <span class="string">""</span>, <span class="string">"tableName"</span>: <span class="string">"library"</span>, <span class="string">"null"</span>: <span class="literal">true</span>, <span class="string">"default"</span>: <span class="string">""</span>, <span class="string">"type"</span>: <span class="string">"datetime"</span> }, { <span class="string">"field"</span>: <span class="string">"name"</span>, <span class="string">"extra"</span>: <span class="string">""</span>, <span class="string">"id"</span>: <span class="string">"D04A39CE-04F3-D1CE-A1D72B04F40920C2"</span>, <span class="string">"key"</span>: <span class="string">"MUL"</span>, <span class="string">"tableName"</span>: <span class="string">"library"</span>, <span class="string">"null"</span>: <span class="literal">true</span>, <span class="string">"default"</span>: <span class="string">""</span>, <span class="string">"type"</span>: <span class="string">"varchar(255)"</span> }] }
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>add sql table to n$.actions.sql.manager.sqlSelect tables store
also asign same id as stores uuid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        tableModel = <span class="keyword">new</span> n$.actions.querybuilder.SqlTableNameModel({
            id: that.tableId,
            tableName: that.title,
            tableAlias: <span class="string">''</span>
        });
        n$.actions.sql.manager.select.tables.addTable(tableModel);

        that.items = [{
            xtype: <span class="string">'qbTableGrid'</span>,
            store: store
        }];
    };

    <span class="keyword">var</span> sheet = n$.sheets.sheet({
        name: <span class="string">'Ext.'</span> + n$.name + <span class="string">'.qbSqlWindowTable'</span>,
        alias: [<span class="string">'widget.qbSqlWindowTable'</span>],
        onInit: onInit
    });

    sheet.addProp(<span class="string">'minWidth'</span>, <span class="number">120</span>);
    sheet.addProp(<span class="string">'height'</span>, <span class="number">180</span>);
    sheet.addProp(<span class="string">'width'</span>, <span class="number">140</span>);
    sheet.addProp(<span class="string">'closable'</span>, <span class="literal">true</span>);
    sheet.addProp(<span class="string">'connection'</span>, connection);
    sheet.addProp(<span class="string">'shadowSprite'</span>, {});
    sheet.addProp(<span class="string">'layout'</span>, {
        type: <span class="string">'fit'</span>
    });

    sheet.subscribers.add(n$.sheets.constants.subscribers.show, <span class="keyword">function</span>(thisView, eOpts) {
        initSQLTable(thisView);
    });
    sheet.subscribers.add(n$.sheets.constants.subscribers.beforeshow, <span class="keyword">function</span>(thisView, eOpts) {
        <span class="keyword">var</span> aWin, prev,</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Cascading window offset</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    offeset = <span class="number">20</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>get all instances from xtype qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        aWin = Ext.ComponentQuery.query(<span class="string">'qbSqlWindowTable'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>start position if there is only one table</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (aWin.length == <span class="number">1</span>) {
            thisView.x = offeset;
            thisView.y = offeset;
        }
        <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>loop through all instances from xtype qbSqlWindowTable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = aWin.length; i &lt; l; i++) {
                <span class="keyword">if</span> (aWin[i] == thisView) {
                    <span class="keyword">if</span> (prev) {
                        thisView.x = prev.x + offeset;
                        thisView.y = prev.y + offeset;
                    }
                }
                <span class="keyword">if</span> (aWin[i].isVisible()) {
                    prev = aWin[i];
                }
            }
        }
        thisView.setPosition(thisView.x, thisView.y);
    });
    sheet.subscribers.add(n$.sheets.constants.subscribers.beforeclose, <span class="keyword">function</span>(thisView, eOpts) {
        closeSQLTable(thisView);
    });

    sheet.init();


}(window.$nameSpace$));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
